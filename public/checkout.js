(()=>{"use strict";var e,t,n,o,r,a,i,p,u,l,c,s,f={643:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(671),r=n(144),a=function(){function e(){(0,o.Z)(this,e)}return(0,r.Z)(e,[{key:"onReady",value:function(){}},{key:"registerEvents",value:function(){}},{key:"initiate",value:function(e){if(e&&!e.includes(salla.config.get("page.slug")))return app.log("The Class For (".concat(e.join(","),") Skipped."));this.onReady(),this.registerEvents(),app.log("The Class For (".concat((null==e?void 0:e.join(","))||"*",") LoadedðŸŽ‰"))}}]),e}();a.initiateWhenReady=function(){var e,t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;"ready"===(null===(e=window.app)||void 0===e?void 0:e.status)?(new this).initiate(n):document.addEventListener("theme::ready",(function(){return(new t).initiate(n)}))};const i=a},326:(e,t,n)=>{function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:()=>o})},671:(e,t,n)=>{function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:()=>o})},144:(e,t,n)=>{function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function r(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{Z:()=>r})},120:(e,t,n)=>{function o(e){return o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},o(e)}n.d(t,{Z:()=>o})},136:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(611);function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,o.Z)(e,t)}},963:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(2),r=n(326);function a(e,t){if(t&&("object"===(0,o.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(e)}},611:(e,t,n)=>{function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}n.d(t,{Z:()=>o})},2:(e,t,n)=>{function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}n.d(t,{Z:()=>o})}},d={};function h(e){var t=d[e];if(void 0!==t)return t.exports;var n=d[e]={exports:{}};return f[e](n,n.exports,h),n.exports}h.d=(e,t)=>{for(var n in t)h.o(t,n)&&!h.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a=h(671),i=h(144),p=h(136),u=h(963),l=h(120),c=h(643),s=function(){function e(){(0,a.Z)(this,e);var t=salla.url.is_page("cart");new FileUploader(".filepond--product-option",{name:"file",maxFileSize:"3MB",instantUpload:t,url:t?salla.cart.getUploadImageEndpoint(salla.config.get("page.id")):void 0,onaddfile:t?void 0:this.addFile,onremovefile:t?void 0:this.removeFile})}return(0,i.Z)(e,[{key:"addFile",value:function(e,t){if(!e){var n=new DataTransfer;n.items.add(t.file),app.element('[type="file"][name="file"]').files=n.files}}},{key:"removeFile",value:function(e,t){var n=app.element('[type="file"][name="file"]');n.type="text",n.type="file",n.value=""}}]),e}(),function(e){(0,p.Z)(r,e);var t,n,o=(t=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,l.Z)(t);if(n){var r=(0,l.Z)(this).constructor;e=Reflect.construct(o,arguments,r)}else e=o.apply(this,arguments);return(0,u.Z)(this,e)});function r(){return(0,a.Z)(this,r),o.apply(this,arguments)}return(0,i.Z)(r,[{key:"onReady",value:function(){var e=this;salla.event.cart.onUpdated((function(t){return e.updateCartPageInfo(t)})),app.watchElements({couponCodeInput:"#coupon-input",couponBtn:"#coupon-btn",couponError:"#coupon-error",subTotal:"#sub-total",totalDiscount:"#total-discount",shippingCost:"#shipping-cost",freeShipping:"#free-shipping",freeShippingBar:"#free-shipping-bar",freeShippingMsg:"#free-shipping-msg",freeShipApplied:"#free-shipping-applied"}),this.initiateCoupon(),new s}},{key:"updateCartPageInfo",value:function(e){var t,n=this;if(!e.count)return window.location.reload();if(null===(t=e.items)||void 0===t||t.forEach((function(e){return n.updateItemInfo(e)})),app.subTotal.innerText=salla.money(e.sub_total),app.toggleElementClassIf(app.totalDiscount,"discounted","hidden",(function(){return!!e.discount})).toggleElementClassIf(app.shippingCost,"has_shipping","hidden",(function(){return!!e.real_shipping_cost})).toggleElementClassIf(app.freeShipping,"has_free","hidden",(function(){return!!e.free_shipping_bar})),app.totalDiscount.querySelector("b").innerText="- "+salla.money(e.discount),app.shippingCost.querySelector("b").innerText=salla.money(e.real_shipping_cost),e.free_shipping_bar){var o=e.free_shipping_bar.has_free_shipping;app.toggleElementClassIf(app.freeShippingBar,"active","hidden",(function(){return!o})).toggleElementClassIf(app.freeShipApplied,"active","hidden",(function(){return o})),app.freeShippingMsg.innerHTML=o?salla.lang.get("pages.cart.has_free_shipping"):salla.lang.get("pages.cart.free_shipping_alert",{amount:salla.money(e.free_shipping_bar.remaining)}),app.freeShippingBar.children[0].style.width=e.free_shipping_bar.percent+"%"}}},{key:"updateItemInfo",value:function(e){var t=document.querySelector("#item-"+e.id);if(t){var n=t.querySelector(".item-total"),o=t.querySelector(".item-price"),r=t.querySelector(".item-regular-price"),a=t.querySelector(".offer-name"),i=t.querySelector(".offer-icon"),p=e.special_price>0,u=salla.money(e.total);u!==n.innerText&&(n.innerText=u,app.anime(n,{scale:[.88,1]})),app.toggleElementClassIf(a,"offer-applied","hidden",(function(){return p})).toggleElementClassIf(i,"offer-applied","hidden",(function(){return p})).toggleElementClassIf(r,"offer-applied","hidden",(function(){return p})).toggleElementClassIf(o,"text-red-400","text-sm text-gray-400",(function(){return p})),o.innerText=salla.money(e.price),p&&(a.innerText=e.offer.names,r.innerText=salla.money(e.product_price))}else salla.log("Can't get the cart item dom for ".concat(e.id,"!"))}},{key:"initiateCoupon",value:function(){var e=this;app.couponCodeInput&&(app.onKeyUp(app.couponCodeInput,(function(e){13===e.keyCode&&app.couponBtn.click(),app.couponError.value="",app.removeClass(app.couponCodeInput,"has-error")})),app.onClick(app.couponBtn,(function(t){var n=app.couponBtn.classList.contains("btn--danger"),o=t.currentTarget;n||app.couponCodeInput.value.length?o.load().then((function(){return n?salla.cart.deleteCoupon():salla.cart.addCoupon(app.couponCodeInput.value)})).then((function(t){return e.toggleCoupon(t,!n)})).catch((function(t){var o,r;return e.showCouponError(null===(o=t.response)||void 0===o||null===(r=o.data)||void 0===r?void 0:r.error.message,!n)})).finally((function(){return o.stop()})):e.showCouponError("* "+salla.lang.get("pages.checkout.enter_coupon"))})))}},{key:"toggleCoupon",value:function(e,t){app.couponError.innerText="",app.couponCodeInput.value=t?app.couponCodeInput.value:"",app.couponCodeInput.toggleAttribute("disabled",t),app.toggleElementClassIf(app.couponBtn,["btn--danger","has-coupon"],["btn-default","has-not-coupon"],(function(){return t})).toggleElementClassIf(app.couponBtn,["btn-default","has-not-coupon"],["btn--danger","has-coupon"],(function(){return!t})).hideElement(app.couponBtn.querySelector(t?"span":"i")).showElement(app.couponBtn.querySelector(t?"i":"span")).removeClass(app.couponCodeInput,"has-error")}},{key:"showCouponError",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];app.couponError.innerText=e||salla.lang.get("pages.checkout.error_occurred"),t&&app.addClass(app.couponCodeInput,"has-error")}}]),r}(c.Z).initiateWhenReady(["cart"]),e=h(671),t=h(144),n=h(136),o=h(963),r=h(120),function(a){(0,n.Z)(l,a);var i,p,u=(i=l,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,r.Z)(i);if(p){var n=(0,r.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,o.Z)(this,e)});function l(){return(0,e.Z)(this,l),u.apply(this,arguments)}return(0,t.Z)(l,[{key:"onReady",value:function(){app.anime(".thanks-item",{translateX:[20,0]});var e=document.querySelector("#invoice-form");salla.order.event.onInvoiceSent((function(t){e.innerHTML=t.data.message,e.classList.add("sent")}))}}]),l}(h(643).Z).initiateWhenReady(["thank-you"])})();