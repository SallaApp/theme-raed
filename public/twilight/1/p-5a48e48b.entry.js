/*!
 * Crafted with â¤ by Salla
 */
import{r as e,h as i,H as t,g as l}from"./p-e72c32ba.js";const n=class{constructor(i){e(this,i)}hideAllOptions(e){this.host.querySelectorAll(`[data-show-when^="options[${e}"]`).forEach((e=>{e.classList.add("hidden");this.hideAllOptions(e.dataset.optionId);this.disableInputs(e)}))}disableInputs(e){e.querySelectorAll("[name]").forEach((e=>{var i;e.setAttribute("disabled","");e.removeAttribute("required");if(((i=e===null||e===void 0?void 0:e.tagName)===null||i===void 0?void 0:i.toLowerCase())==="select"){e.value=""}if(["checkbox"].includes(e.getAttribute("type"))&&e.hasOwnProperty("checked")){e.checked=false}}))}changeHandler(e){var i;salla.event.emit("salla-onditional-fields::change",e);salla.log("Received the change event: ",e);if(!e.target||!["SELECT"].includes(e.target.tagName)&&!["checkbox"].includes(e.target.getAttribute("type"))){salla.log("Ignore the change because is not support input: "+(((i=e===null||e===void 0?void 0:e.target)===null||i===void 0?void 0:i.tagName)||"N/A"));return}let t=e.target.name.replace("[]","");let l=e.target.getAttribute("type")==="checkbox";salla.log("Trying to find all the element with condition:",`[data-show-when^="${t}"]`);this.host.querySelectorAll(`[data-show-when^="${t}"]`).forEach((i=>{let t=!(i===null||i===void 0?void 0:i.dataset.showWhen.includes("!="));let n=i===null||i===void 0?void 0:i.dataset.showWhen.replace(/(.*)(=|!=)(.*)/gm,"$3").trim();let o;if(l){let i=Array.from(this.host.querySelectorAll(`input[name="${e.target.name}"]:checked`),(e=>e===null||e===void 0?void 0:e.value));o=i.includes(n.toString())}else{o=n===e.target.value}salla.log("The input is ",l?"Multiple":"Single"," value:",o);let s=t&&o||!t&&!o;if(s){i.classList.remove("hidden");i.querySelectorAll("[name]").forEach((e=>{e.removeAttribute("disabled");const t=e.closest(".s-product-options-option");if(t.dataset.optionRequired==="true"){e.setAttribute("required","")}if(e.getAttribute("type")==="checkbox"){const i=Array.from(document.querySelectorAll(`input[type="checkbox"][name="${e.getAttribute("name")}"]`));const t=i.some((e=>e.checked));if(t){i.forEach((e=>{e.removeAttribute("required")}))}}if(!["checkbox"].includes(e.getAttribute("type"))&&i.getElementsByClassName("required").length){e.setAttribute("required","")}}))}else{this.hideAllOptions(i.dataset.optionId);i.classList.add("hidden");this.disableInputs(i)}}))}componentDidRender(){this.host.querySelectorAll(`[data-show-when]`).forEach((e=>{var i;let t=(i=e===null||e===void 0?void 0:e.dataset)===null||i===void 0?void 0:i.showWhen.replace(/(.*)(=|!=)(.*)/gm,"$1").trim();if(!t){return}this.changeHandler({target:this.host.querySelector('[name^="'+t+'"]')})}))}render(){return i(t,null,i("slot",null))}get host(){return l(this)}};export{n as salla_conditional_fields};
//# sourceMappingURL=p-5a48e48b.entry.js.map