/*! For license information please see 298.js.LICENSE.txt */
"use strict";(self.webpackChunkTheme_Raed=self.webpackChunkTheme_Raed||[]).push([[298],{4298:(s,e,t)=>{t.r(e),t.d(e,{salla_scopes:()=>a});var l,i=t(6298),o=t(116);!function(s){s.DEFAULT="default",s.AVAILABILITY="availability"}(l||(l={}));const a=class{constructor(s){(0,i.r)(this,s),this.translationLoaded=!1,this.mode=l.DEFAULT,this.scopes=[],this.originalScopesList=[],this.isOpenedBefore=salla.storage.get("branch-choosed-before"),this.hasError=!1,this.selection="optional",this.searchDisplayLimit=6,this.getFormTitle=()=>{var s;return(null===(s=this.originalScopesList)||void 0===s?void 0:s.length)<2?"":this.mode===l.DEFAULT?salla.lang.get("blocks.scope.shopping_from_another_branch"):salla.lang.get("blocks.scope.search_for_availability_in_other_branches")},salla.event.on("scopes::open",(({mode:s=null,product_id:e=null})=>{this.open(s,e)})),salla.lang.onLoaded((()=>{this.translationLoaded=!0}))}async close(){var s;return await(null===(s=this.modal)||void 0===s?void 0:s.close())}async open(s=l.DEFAULT,e=null){return this.setScopeValues([]),void 0!==s&&[l.AVAILABILITY,l.DEFAULT].includes(s)?this.mode=s:this.mode=l.DEFAULT,this.modal.open(),await salla.api.withoutNotifier((s==l.AVAILABILITY?salla.scope.getProductAvailability(e):salla.scope.get()).then((e=>{s==l.AVAILABILITY?this.setScopeValues(e.data):this.setScopeValues(e.data.scopes)})).catch((s=>{console.log(s),this.hasError=!0})).finally((()=>{this.modal.stopLoading()})))}async handleSubmit(){let s={id:this.current_scope.id};return this.changeBtn.load(),await salla.scope.change(s).then((()=>{salla.storage.set("branch-choosed-before",!0),salla.storage.set("scope",{type:this.current_scope.type,id:this.current_scope.id});var s=new URL(window.location.href);s.searchParams.set("scope",this.current_scope.id),window.location.href=s.toString(),window.location.replace(s.toString())})).catch((s=>console.log(s))).finally((()=>{this.changeBtn.stop()}))}setScopeValues(s){this.scopes=s,this.originalScopesList=s,1==s.length?(this.current_scope=s[0],this.selected_scope=s[0]):(this.current_scope=s.find((s=>s.selected)),this.selected_scope=s.find((s=>s.selected)))}handleSearchFieldTyping(s){let e=s.target.value.toLocaleLowerCase();this.scopes=e?this.originalScopesList.filter((s=>s.name.toLowerCase().includes(e))):this.originalScopesList}handleScopeSelection(s){this.current_scope=this.scopes.find((e=>e.id==s.target.value))}placeholderContent(){return(0,i.h)("salla-placeholder",{alignment:"center",class:"s-scopes-placeholder"},(0,i.h)("span",{slot:"title"},salla.lang.get("blocks.scope.branch_looking_for_not_found")),(0,i.h)("span",{slot:"description"},salla.lang.get("blocks.scope.our_services_not_available_in_this_branch")))}defaultContent(){return[(0,i.h)("div",{class:"s-scopes-container s-scrollbar"},this.scopes.map((s=>(0,i.h)("div",{class:"s-scopes-input-wrap","data-selection":this.selection},(0,i.h)("input",{id:`${this.selection} + '_scope_' + ${s.id}`,name:"lang",type:"radio",value:s.id,onChange:s=>this.handleScopeSelection(s),class:"s-scopes-input",checked:!!this.current_scope&&this.current_scope.id==s.id}),(0,i.h)("label",{htmlFor:`${this.selection} + '_scope_' + ${s.id}`,class:"s-scopes-label s-scopes-clickable"},(0,i.h)("span",null,s.name)))))),this.footerContent()]}availabilityContent(){return(0,i.h)("div",{class:"s-scopes-container"},this.scopes.map((s=>{var e,t,o,a,h,n;return(0,i.h)("div",{class:"s-scopes-input-wrap","data-selection":this.selection},(0,i.h)("h2",{class:{"s-scopes-label":!0,"s-scopes-clickable":this.mode===l.DEFAULT}},(0,i.h)("span",null,s.name)),(0,i.h)("h2",{style:{color:null===(t=null===(e=s)||void 0===e?void 0:e.availability)||void 0===t?void 0:t.color},class:`s-scopes-${null===(a=null===(o=s)||void 0===o?void 0:o.availability)||void 0===a?void 0:a.key}`},null===(n=null===(h=s)||void 0===h?void 0:h.availability)||void 0===n?void 0:n.label))})))}footerContent(){return(0,i.h)("div",{class:"s-scopes-footer"},(0,i.h)("slot",{name:"footer"},(0,i.h)("salla-button",{ref:s=>this.changeBtn=s,disabled:!this.current_scope,onClick:()=>this.handleSubmit(),class:"s-scopes-submit","loader-position":"center",width:"wide"},salla.lang.get("common.elements.confirm"))))}render(){return(0,i.h)(i.H,null,(0,i.h)("salla-modal",{ref:s=>this.modal=s,isClosable:!(!this.isOpenedBefore&&"optional"!=this.selection),class:"s-scopes-modal",isLoading:!0,"has-skeleton":!0},(0,i.h)("div",{slot:"loading"},(0,i.h)("div",{class:"s-scopes-skeleton"},(0,i.h)("salla-list-tile",{class:"s-scopes-header"},(0,i.h)("div",{slot:"icon",class:"s-scopes-header-icon"},(0,i.h)("salla-skeleton",{type:"circle"})),(0,i.h)("div",{slot:"title",class:"s-scopes-header-title mb-5"},(0,i.h)("salla-skeleton",{height:"15px",width:"50%"})),(0,i.h)("div",{slot:"subtitle",class:"s-scopes-header-subtitle"},(0,i.h)("salla-skeleton",{height:"10px"}),(0,i.h)("salla-skeleton",{height:"10px",width:"75%"}))),(0,i.h)("div",{class:"s-scopes-skeleton-search"},(0,i.h)("salla-skeleton",{height:"10px",width:"50%"}),(0,i.h)("salla-skeleton",{height:"30px",width:"100%"})),(0,i.h)("div",{class:"s-scopes-skeleton-scopes"},(0,i.h)("salla-skeleton",{height:"10px",width:"30%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"25%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"30%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"25%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"30%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"25%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"30%"}),(0,i.h)("salla-skeleton",{height:"10px",width:"25%"})),(0,i.h)("div",{class:"s-scopes-skeleton-btn"},(0,i.h)("salla-skeleton",{height:"40px",width:"100%"})))),(0,i.h)("salla-list-tile",{class:this.originalScopesList.length?"s-scopes-header block":"s-hidden"},(0,i.h)("div",{slot:"icon",class:"s-scopes-header-icon",innerHTML:'\x3c!-- Generated by IcoMoon.io --\x3e\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">\n<title>store-alt</title>\n<path d="M6.667 24h5.333c0.736 0 1.333-0.596 1.333-1.333s-0.597-1.333-1.333-1.333h-5.333c-0.736 0-1.333 0.596-1.333 1.333s0.597 1.333 1.333 1.333zM31.86 10.071l-4-8c-0.227-0.452-0.688-0.737-1.193-0.737h-21.333c-0.505 0-0.967 0.285-1.193 0.737l-4 8c-0.092 0.184-0.14 0.389-0.14 0.596v18.667c0 0.737 0.597 1.333 1.333 1.333h29.333c0.736 0 1.333-0.596 1.333-1.333v-18.667c0-0.207-0.048-0.412-0.14-0.596zM6.157 4h19.685l3.333 6.667h-26.352zM24 28h-5.333v-9.333h5.333zM29.333 28h-2.667v-10.667c0-0.737-0.597-1.333-1.333-1.333h-8c-0.736 0-1.333 0.596-1.333 1.333v10.667h-13.333v-14.667h26.667zM6.667 18.667h5.333c0.736 0 1.333-0.596 1.333-1.333s-0.597-1.333-1.333-1.333h-5.333c-0.736 0-1.333 0.596-1.333 1.333s0.597 1.333 1.333 1.333z"></path>\n</svg>\n'}),(0,i.h)("div",{slot:"title",class:"s-scopes-header-title"},salla.lang.get("blocks.scope.you_are_browse_store_from")),(0,i.h)("div",{slot:"subtitle",class:"s-scopes-header-subtitle"},this.selected_scope?this.selected_scope.name:"")),(0,i.h)("div",{class:"s-scopes-wrap"},!!this.originalScopesList.length&&(0,i.h)("h4",{class:"s-scopes-title"},this.getFormTitle()),this.originalScopesList.length>this.searchDisplayLimit?(0,i.h)("div",{class:"s-scopes-search-wrapper"},(0,i.h)("div",{class:"s-scopes-search-icon",innerHTML:o.S}),(0,i.h)("input",{type:"text",class:"s-scopes-search-input",onInput:s=>this.handleSearchFieldTyping(s),enterkeyhint:"search",placeholder:salla.lang.get("blocks.scope.searching_for_a_branch")})):"",this.hasError||this.scopes.length<2?this.placeholderContent():this.mode===l.DEFAULT?this.defaultContent():this.availabilityContent())))}componentDidLoad(){this.isOpenedBefore||"mandatory"!=this.selection||this.open()}};a.style=".s-scopes-availability-content{display:flex;justify-content:center;align-items:center}.s-scopes-placeholder{flex:0 0 85%}"},116:(s,e,t)=>{t.d(e,{S:()=>l});const l='\x3c!-- Generated by IcoMoon.io --\x3e\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">\n<title>search</title>\n<path d="M30.276 28.391l-7.576-7.576c1.644-2.053 2.633-4.652 2.633-7.481 0-6.616-5.384-12-12-12s-12 5.384-12 12 5.384 12 12 12c2.829 0 5.428-0.989 7.481-2.633l7.576 7.576c0.26 0.26 0.601 0.391 0.943 0.391s0.683-0.131 0.943-0.391c0.521-0.521 0.521-1.364 0-1.885zM13.333 22.667c-5.147 0-9.333-4.187-9.333-9.333s4.187-9.333 9.333-9.333 9.333 4.187 9.333 9.333-4.187 9.333-9.333 9.333z"></path>\n</svg>\n'}}]);