/*! For license information please see add-product-toast.js.LICENSE.txt */
(()=>{var t={235:(t,e,r)=>{var n=r(844)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},651:t=>{function e(r){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},844:(t,e,r)=>{var n=r(651).default;function o(){"use strict";t.exports=o=function(){return r},t.exports.__esModule=!0,t.exports.default=t.exports;var e,r={},i=Object.prototype,a=i.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",d=c.toStringTag||"@@toStringTag";function p(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{p({},"")}catch(e){p=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),a=new H(n||[]);return s(i,"_invoke",{value:P(t,r,a)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}r.wrap=f;var v="suspendedStart",y="suspendedYield",g="executing",m="completed",b={};function w(){}function _(){}function x(){}var k={};p(k,u,(function(){return this}));var L=Object.getPrototypeOf,O=L&&L(L(I([])));O&&O!==i&&a.call(O,u)&&(k=O);var T=x.prototype=w.prototype=Object.create(k);function j(t){["next","throw","return"].forEach((function(e){p(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function r(o,i,s,c){var u=h(t[o],t,i);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==n(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,s,c)}),(function(t){r("throw",t,s,c)})):e.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,c)}))}c(u.arg)}var o;s(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function P(t,r,n){var o=v;return function(i,a){if(o===g)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:e,done:!0}}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var c=E(s,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===v)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=g;var u=h(t,r,n);if("normal"===u.type){if(o=n.done?m:y,u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function E(t,r){var n=r.method,o=t.iterator[n];if(o===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,t.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function M(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function H(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(M,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[u];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function r(){for(;++o<t.length;)if(a.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(n(t)+" is not iterable")}return _.prototype=x,s(T,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:_,configurable:!0}),_.displayName=p(x,d,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,p(t,d,"GeneratorFunction")),t.prototype=Object.create(T),t},r.awrap=function(t){return{__await:t}},j(C.prototype),p(C.prototype,l,(function(){return this})),r.AsyncIterator=C,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new C(f(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(T),p(T,d,"Generator"),p(T,u,(function(){return this})),p(T,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},r.values=I,H.prototype={constructor:H,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),b}},r}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";function t(t,e,r,n,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void r(t)}s.done?e(c):Promise.resolve(c).then(n,o)}function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function s(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(s=function(){return!!t})()}function c(t){var e="function"==typeof Map?new Map:void 0;return c=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(s())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&a(o,r.prototype),o}(t,arguments,i(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,t)},c(t)}var u=r(235),l=r.n(u);function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}var p=function(r){function n(){var t,r,o,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),r=this,o=i(o=n),(t=function(t,r){if(r&&("object"==e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(r,d()?Reflect.construct(o,[],i(r).constructor):o.apply(r,a))).classList.add("s-add-product-toast"),t.isVisible=!1,t.progressInterval=null,t.remainingTime=0,t.isPaused=!1,t.duration=5e3,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(n,r),s=n,c=[{key:"connectedCallback",value:function(){var t,e=this;"ready"===(null===(t=window.app)||void 0===t?void 0:t.status)?this.init():document.addEventListener("theme::ready",(function(){return e.init()}))}},{key:"disconnectedCallback",value:function(){this.clearTimers()}},{key:"init",value:function(){var t=this;salla.lang.onLoaded((function(){salla.lang.addBulk({"pages.cart.added_to_cart":{ar:"تمت الإضافة إلي سلة التسوق",en:"Added to Cart"},"pages.cart.view_cart":{ar:"عرض السلة",en:"View Cart"}}),t.successMessage=salla.lang.get("pages.cart.added_to_cart"),t.viewCartText=salla.lang.get("pages.cart.view_cart"),t.checkoutText=salla.lang.get("pages.cart.complete_order"),t.showMoreText=salla.lang.get("pages.checkout.show_more")})),this.cartUrl=salla.url.get("cart"),this.checkIconUrl=salla.url.asset("images/check.svg"),salla.event.on("Product Added",(function(e){return t.handleProductAdded(e)})),this.render()}},{key:"handleProductAdded",value:(u=l().mark((function t(e){var r,n,o,i,a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,(n=e||[]).length){t.next=4;break}return t.abrupt("return");case 4:if(o=n[0].cart_item_id){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,salla.cart.api.details(null,["options"]);case 9:if(null!=(i=t.sent)&&null!==(r=i.data)&&void 0!==r&&null!==(r=r.cart)&&void 0!==r&&r.items){t.next=12;break}return t.abrupt("return");case 12:if(a=i.data.cart.items.find((function(t){return t.id===o}))){t.next=15;break}return t.abrupt("return");case 15:this.open({id:a.product_id,name:a.product_name,image:a.product_image,price:a.total,originalPrice:a.original_price*a.quantity,hasDiscount:a.has_discount,isOnSale:a.is_on_sale,quantity:a.quantity,url:a.url,options:this.extractOptions(a.options)}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),salla.log("Error processing product added event:",t.t0);case 21:case"end":return t.stop()}}),t,this,[[0,18]])})),p=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=u.apply(e,r);function a(e){t(i,n,o,a,s,"next",e)}function s(e){t(i,n,o,a,s,"throw",e)}a(void 0)}))},function(t){return p.apply(this,arguments)})},{key:"extractOptions",value:function(t){return null!=t&&t.length?t.reduce((function(t,e){var r;if("splitter"===e.type)return t;if(null!==(r=e.details)&&void 0!==r&&r.length){var n="multiple-options"===e.type?e.details.filter((function(t){return t.is_selected})):[e.details.find((function(t){return t.is_selected}))];n[0]&&t.push({name:e.name,value:n.map((function(t){return t.name})).join(", ")})}else if(e.value){var o=["image","file","map"].includes(e.type);t.push({name:e.name,value:e.value,hideValue:o})}return t}),[]):[]}},{key:"open",value:function(t){var e=this;this.product=t,this.progressPercent=100,this.isVisible=!0,this.updateDOM(),requestAnimationFrame((function(){e.classList.add("s-add-product-toast--visible")})),this.startAutoHideTimer()}},{key:"close",value:function(){var t=this;this.clearTimers(),this.classList.remove("s-add-product-toast--visible"),setTimeout((function(){t.isVisible=!1,t.product=null,t.updateDOM()}),300)}},{key:"startAutoHideTimer",value:function(){var t=this;this.clearTimers(),this.isPaused=!1,this.remainingTime=this.duration,this.progressPercent=100,this.progressInterval=setInterval((function(){if(!t.isPaused){t.remainingTime=Math.max(0,t.remainingTime-50),t.progressPercent=t.remainingTime/t.duration*100;var e=t.querySelector(".s-add-product-toast__progress-bar");e&&(e.style.width="".concat(t.progressPercent,"%")),t.remainingTime<=0&&t.close()}}),50)}},{key:"clearTimers",value:function(){this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=null)}},{key:"escapeHTML",value:function(){return String(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}},{key:"updateDOM",value:function(){var t=this;if(this.isVisible&&this.product){var e=this.product.options||[],r=e.slice(0,3),n=e.length>3,o=salla.money(this.product.price),i=salla.money(this.product.originalPrice);this.setAttribute("onmouseenter","this.isPaused=true"),this.setAttribute("onmouseleave","this.isPaused=false"),this.innerHTML='\n      <div class="s-add-product-toast__progress">\n        <div class="s-add-product-toast__progress-bar" style="width:'.concat(this.progressPercent,'%"></div>\n      </div>\n      <div class="s-add-product-toast__header">\n        <div class="s-add-product-toast__header-content">\n          <img src="').concat(this.checkIconUrl,'" alt="Success" width="16" height="16" class="s-add-product-toast__icon" />\n          <span class="s-add-product-toast__title">').concat(this.successMessage,'</span>\n        </div>\n        <button type="button" class="s-add-product-toast__close" aria-label="Close"><i class="sicon-cancel"></i></button>\n      </div>\n      <div class="s-add-product-toast__divider"></div>\n      <div class="s-add-product-toast__body">\n        <a href="').concat(this.product.url,'" class="s-add-product-toast__image">\n          <img src="').concat(this.product.image,'" alt="').concat(this.escapeHTML(this.product.name),'" loading="lazy" />\n        </a>\n        <div class="s-add-product-toast__details">\n          <a href="').concat(this.product.url,'" class="s-add-product-toast__name">').concat(this.escapeHTML(this.product.name),"</a>\n          ").concat(r.length?'\n            <div class="s-add-product-toast__options">\n              '.concat(r.map((function(t){return t.hideValue?"<span>".concat(t.name,"</span>"):"<span>".concat(t.name,": ").concat(t.value,"</span>")})).join(""),"\n              ").concat(n?'<a href="'.concat(this.cartUrl,'" class="s-add-product-toast__show-more">').concat(this.showMoreText,"</a>"):"","\n            </div>\n          "):"",'\n        </div>\n        <div class="s-add-product-toast__price">\n          ').concat(this.product.hasDiscount||this.product.isOnSale?'<div class="s-add-product-toast__price-sale">'.concat(o,'</div><div class="s-add-product-toast__price-original">').concat(i,"</div>"):"<div>".concat(o,"</div>"),'\n        </div>\n      </div>\n      <div class="s-add-product-toast__actions">\n        <salla-button id="toast-submit" loader-position="center" width="wide" color="primary" fill="solid">\n          <span>').concat(this.checkoutText,'</span>\n          <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M2 12C2 8.46252 2 6.69377 3.0528 5.5129C3.22119 5.32403 3.40678 5.14935 3.60746 4.99087C4.86213 4 6.74142 4 10.5 4H13.5C17.2586 4 19.1379 4 20.3925 4.99087C20.5932 5.14935 20.7788 5.32403 20.9472 5.5129C22 6.69377 22 8.46252 22 12C22 15.5375 22 17.3062 20.9472 18.4871C20.7788 18.676 20.5932 18.8506 20.3925 19.0091C19.1379 20 17.2586 20 13.5 20H10.5C6.74142 20 4.86213 20 3.60746 19.0091C3.40678 18.8506 3.22119 18.676 3.0528 18.4871C2 17.3062 2 15.5375 2 12Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M10 16H11.5" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M14.5 16L18 16" stroke="currentColor" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 9H22" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg>\n        </salla-button>\n        <salla-button href="').concat(this.cartUrl,'" fill="outline" width="wide" color="gray">\n          <span>').concat(this.viewCartText,'</span>\n          <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M3.06164 14.4413L3.42688 12.2985C3.85856 9.76583 4.0744 8.49951 4.92914 7.74975C5.78389 7 7.01171 7 9.46734 7H14.5327C16.9883 7 18.2161 7 19.0709 7.74975C19.9256 8.49951 20.1414 9.76583 20.5731 12.2985L20.9384 14.4413C21.5357 17.946 21.8344 19.6983 20.9147 20.8491C19.995 22 18.2959 22 14.8979 22H9.1021C5.70406 22 4.00504 22 3.08533 20.8491C2.16562 19.6983 2.4643 17.946 3.06164 14.4413Z" stroke="currentColor" stroke-width="1.5"/><path d="M7.5 9L7.71501 5.98983C7.87559 3.74176 9.7462 2 12 2C14.2538 2 16.1244 3.74176 16.285 5.98983L16.5 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>\n        </salla-button>\n      </div>\n    '),this.querySelector(".s-add-product-toast__close").addEventListener("click",(function(){return t.close()})),this.querySelector("#toast-submit").addEventListener("click",(function(){salla.cart.submit(),t.close()}))}else this.innerHTML=""}},{key:"render",value:function(){this.innerHTML=""}}],c&&o(s.prototype,c),Object.defineProperty(s,"prototype",{writable:!1}),s;var s,c,u,p}(c(HTMLElement));customElements.define("salla-add-product-toast",p)})()})();