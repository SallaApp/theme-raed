/*! For license information please see 92.js.LICENSE.txt */
"use strict";(self.webpackChunkTheme_Raed=self.webpackChunkTheme_Raed||[]).push([[92],{4901:(t,s,i)=>{i.d(s,{H:()=>l}),salla.event.setMaxListeners(20);class e extends salla.AppHelpers{setHost(t){this.host=t}getElement(t){return this.host.querySelector(t)}getAttribute(t,s){var i;return null===(i=this.getElement(t))||void 0===i?void 0:i.getAttribute(s)}val(t){return this.getAttribute(t,"value")}isUser(){return"user"===salla.config.get("user.type")}}const l=new e},9092:(t,s,i)=>{i.r(s),i.d(s,{salla_product_availability:()=>n});var e=i(6298),l=i(4901);const a='\x3c!-- Generated by IcoMoon.io --\x3e\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">\n<title>bell-ring</title>\n<path d="M2.667 13.333v-4c0-2.592 0.748-5.107 2.161-7.271 0.404-0.616 0.231-1.443-0.387-1.845-0.616-0.401-1.443-0.228-1.845 0.388-1.699 2.599-2.596 5.617-2.596 8.728v4c0 0.736 0.596 1.333 1.333 1.333s1.333-0.596 1.333-1.333zM25.333 15.647v-6.313c0-5.147-4.188-9.333-9.333-9.333s-9.333 4.187-9.333 9.333v6.312l-5.157 9.027c-0.236 0.413-0.235 0.92 0.004 1.331 0.239 0.412 0.679 0.664 1.153 0.664h8c0 2.941 2.392 5.333 5.333 5.333s5.333-2.392 5.333-5.333h8c0.475 0 0.915-0.252 1.153-0.664 0.239-0.411 0.24-0.917 0.004-1.331zM16 29.333c-1.471 0-2.667-1.196-2.667-2.667h5.333c0 1.472-1.196 2.667-2.667 2.667zM4.965 24l4.193-7.339c0.113-0.2 0.175-0.429 0.175-0.661v-6.667c0-3.676 2.991-6.667 6.667-6.667s6.667 2.991 6.667 6.667v6.667c0 0.232 0.061 0.46 0.176 0.661l4.192 7.339zM29.403 0.603c-0.403-0.616-1.232-0.789-1.845-0.387-0.617 0.403-0.791 1.229-0.387 1.845 1.415 2.165 2.163 4.68 2.163 7.272v4c0 0.736 0.596 1.333 1.333 1.333s1.333-0.597 1.333-1.333v-4c0-3.112-0.899-6.132-2.597-8.731z"></path>\n</svg>\n',n=class{constructor(t){(0,e.r)(this,t),this.isUser=l.H.isUser(),this.translationLoaded=!1,this.productId=salla.config.get("page.id"),this.isSubscribed=!1,this.submit=async()=>{if(this.isUser)return salla.api.product.availabilitySubscribe(this.productId).then((()=>this.isSubscribed=!0));let t={id:this.productId};if(this.channels_.includes("sms")){let{phone:s,countryCode:i}=await this.mobileInput.getValues();t.country_code=i,t.phone=s}return this.channels_.includes("email")&&""!==this.email.value&&(t.email=this.email.value),await this.validateform(),this.btn.load().then((()=>this.btn.disable())).then((()=>salla.api.product.availabilitySubscribe(t))).then((()=>{this.isSubscribed=!0,salla.storage.set(`product-${this.productId}-subscribed`,!0)})).then((()=>this.btn.stop())).then((()=>this.modal.close())).catch((()=>this.btn.stop()&&this.btn.enable()))},this.typing=(t,s)=>{const i=t.target.nextElementSibling;t.target.classList.remove("s-has-error"),(null==i?void 0:i.classList.contains("s-product-availability-error-msg"))&&(i.innerText=""),"Enter"==t.key&&s()},salla.lang.onLoaded((()=>{var t;this.translationLoaded=!0,this.title_=this.host.title||salla.lang.get("pages.products.notify_availability_title"),null===(t=this.modal)||void 0===t||t.setTitle(this.title_)})),this.isUser||(this.channelsWatcher(this.channels),this.title_=this.host.title||salla.lang.get("pages.products.notify_availability_title"),this.host.removeAttribute("title"),this.isVisitorSubscribed=salla.storage.get(`product-${this.productId}-subscribed`))}channelsWatcher(t){this.channels_=t?t.split(","):[]}async validateform(){try{if(this.channels_.includes("email")){const t=l.H.isValidEmail(this.email.value);if(t)return;!t&&this.validateField(this.email,salla.lang.get("common.elements.email_is_valid"))}if(this.channels_.includes("sms")&&await this.mobileInput.isValid())return}catch(t){throw"Please insert required fields"}}validateField(t,s){t.classList.add("s-has-error"),t.nextElementSibling.innerText="* "+s}render(){return(0,e.h)(e.H,{class:"s-product-availability-wrap"},this.isSubscribed||this.isVisitorSubscribed?(0,e.h)("div",{class:"s-product-availability-subscribed"},(0,e.h)("span",{innerHTML:a,class:"s-product-availability-subs-icon"})," ",salla.lang.get("pages.products.notify_availability_success")):(0,e.h)("salla-button",{width:"wide",onClick:()=>this.isUser?this.submit():this.modal.open()},salla.lang.get("pages.products.notify_availability")),this.isUser||this.isSubscribed||this.isVisitorSubscribed?"":this.renderModal())}renderModal(){return(0,e.h)("salla-modal",{ref:t=>this.modal=t,"modal-title":this.title_,subTitle:salla.lang.get("pages.products.notify_availability_subtitle"),width:"sm"},(0,e.h)("span",{slot:"icon",innerHTML:a}),(0,e.h)("div",{class:"s-product-availability-body"},this.channels_.includes("email")?[(0,e.h)("label",{class:"s-product-availability-label"},salla.lang.get("common.elements.email")),(0,e.h)("input",{class:"s-product-availability-input",onKeyDown:t=>this.typing(t,this.submit),placeholder:salla.lang.get("common.elements.email_placeholder")||"your@email.com",ref:t=>this.email=t,type:"email"}),(0,e.h)("span",{class:"s-product-availability-error-msg"})]:"",this.channels_.includes("sms")?[(0,e.h)("label",{class:"s-product-availability-label"},salla.lang.get("common.elements.mobile")),(0,e.h)("salla-tel-input",{ref:t=>this.mobileInput=t,onKeyDown:t=>this.typing(t,this.submit)})]:""),(0,e.h)("div",{slot:"footer",class:"s-product-availability-footer"},(0,e.h)("salla-button",{class:"modal-cancel-btn",width:"wide",color:"light",fill:"outline",onClick:()=>this.modal.close()},salla.lang.get("common.elements.cancel")),(0,e.h)("salla-button",{class:"submit-btn","loader-position":"center",width:"wide",ref:t=>this.btn=t,onClick:()=>this.submit()},salla.lang.get("common.elements.submit"))))}get host(){return(0,e.g)(this)}static get watchers(){return{channels:["channelsWatcher"]}}};n.style=""}}]);